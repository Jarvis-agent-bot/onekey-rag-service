# DeFi 项目安全评分系统 - 需求文档

> 轻量级 Demo 项目：类似老虎证券 IPO 评分，专注于 Ethereum DeFi 项目的安全评估

---

## 一、项目概述

### 1.1 定位

一个 **轻量级 Demo**，为用户提供 DeFi 项目的安全评分和风险指导。

### 1.2 核心特点

| 特点 | 说明 |
|-----|------|
| **轻量级** | Demo 级别，不做过度设计 |
| **仅 Ethereum** | 初期只支持 ETH 主网 |
| **运营驱动** | 评分由运营手动编辑，非实时计算 |
| **无用户系统** | 无需登录，纯展示 |
| **桌面优先** | 不考虑响应式 |

---

## 二、市场分析与竞品对比

### 2.1 市场现状

#### 现有竞品分析

| 产品 | 类型 | 评分方式 | 优势 | 劣势 |
|-----|------|---------|------|------|
| [DeFi Safety](https://defisafety.com) | 安全评分平台 | 人工审核 PQR (0-100) | 专业详细、行业认可 | 更新慢、覆盖有限、纯英文、普通用户难懂 |
| [L2Beat](https://l2beat.com) | L2 风险评估 | 多维度分析 | L2 深度分析 | 仅限 L2，不覆盖 DeFi 协议 |
| [DefiLlama](https://defillama.com) | 数据仪表盘 | 无评分，纯数据 | 数据全、更新快、免费 | 无安全评估、无指导性结论 |
| [CertiK Skynet](https://skynet.certik.com) | 安全评分 | 自动化+审计 | 技术深度、实时监控 | 偏向审计机构视角，普通用户难懂 |
| [Consensys DeFi Score](https://github.com/Consensys/defi-score) | 开源框架 | 算法计算 | 开源透明 | 已停止维护，仅限借贷协议 |

#### 交易所 DeFi 产品对比

| 平台 | 产品形态 | 特点 | 与我们的差异 |
|-----|---------|------|-------------|
| [OKX Earn](https://www.okx.com/earn) | 理财产品入口 | 100+ 币种、最高 70% APY、流动性质押(BETH/OKSOL) | **卖产品**：引导用户购买自家理财，非独立评估 |
| [Binance Earn](https://www.binance.com/earn) | 理财产品入口 | 180+ 币种、锁仓/活期/DeFi Staking、BETH/WBETH | **卖产品**：同上，平台利益导向 |
| [Bybit Earn](https://www.bybit.com) | 理财产品入口 | 结构化产品、双币理财 | **卖产品**：同上 |

### 2.2 市场空白

```
                    专业深度
                       ↑
         DeFi Safety   │   CertiK
         (安全评分)     │   (审计)
                       │
    ←──────────────────┼──────────────────→ 用户友好
                       │
         DefiLlama     │   【市场空白】
         (纯数据)       │   用户友好 + 安全指导
                       │   + 中文本地化
                       ↓
                    数据展示
```

**关键洞察**：

| 空白点 | 说明 |
|-------|------|
| 用户友好的安全指导 | DeFi Safety 太专业，普通用户看不懂 |
| 中文本地化 | 主流平台都是英文，中文用户不友好 |
| 独立第三方视角 | 交易所产品都是"卖货"导向，非独立评估 |
| AI 辅助分析 | 现有平台都是人工或固定规则，无 RAG/AI |

### 2.3 核心竞争力

#### 与专业评分平台的差异

| 对比维度 | DeFi Safety | 我们 |
|---------|-------------|------|
| **目标用户** | 专业投资者/机构 | 普通 DeFi 用户 |
| **报告形式** | 长篇专业审计报告 | 一句话结论 + 评分 |
| **更新频率** | 周/月级 | 运营驱动，可快速响应 |
| **语言** | 纯英文 | 中文优先 |
| **信息来源** | 人工调研 | RAG 整合 + 人工审核 |

#### 与交易所 DeFi 产品的差异

| 对比维度 | OKX/Binance Earn | 我们 |
|---------|------------------|------|
| **立场** | 平台利益导向（卖理财产品） | 独立第三方（纯评估） |
| **覆盖范围** | 仅自家上架的产品 | 全市场 DeFi 协议 |
| **风险披露** | 最小化风险提示 | 明确风险警示 |
| **评分透明度** | 无评分，只展示 APY | 多维度评分 + 依据 |

#### 核心价值主张

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   用户痛点: "这个 DeFi 项目安全吗？我该参与吗？"              │
│                                                             │
│   现有方案的问题:                                            │
│   ├─ DeFi Safety → 报告太专业，看不懂                        │
│   ├─ DefiLlama  → 只有数据，不知道怎么判断                   │
│   ├─ OKX/Binance → 只推荐自家产品，不客观                    │
│   └─ Twitter    → 信息太杂，难辨真假                         │
│                                                             │
│   我们的方案:                                                │
│   ┌─────────────────────────────────────────────────────┐   │
│   │  评分: 85/100 [低风险]                               │   │
│   │                                                     │   │
│   │  一句话结论: "Lido 是最大的 ETH 质押协议，            │   │
│   │              经过多次审计，安全性较高，               │   │
│   │              但需注意 Slashing 风险"                 │   │
│   │                                                     │   │
│   │  [查看详细分析] [信息来源]                            │   │
│   └─────────────────────────────────────────────────────┘   │
│                                                             │
│   差异化: 简单直接 + 中文友好 + 独立客观 + RAG 支撑          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.4 竞争力总结

| 竞争力 | 具体表现 |
|-------|---------|
| **简单直接** | 一个分数 + 一句话风险提示，普通人看得懂 |
| **独立客观** | 非交易所导向，不"卖货"，纯第三方评估 |
| **中文优先** | 服务中文用户，本地化优势 |
| **RAG 驱动** | 整合多源信息（审计报告、官方文档、链上数据） |
| **运营驱动** | 人工把控质量，可快速响应热点项目 |
| **钱包整合** | 可与 OneKey 钱包深度整合，形成产品闭环 |

**一句话定位**：
> **"让 DeFi 风险评估像看股票评级一样简单"**
> - DeFi Safety 是给专业人士的审计报告
> - 我们是给普通用户的 **"建议参与 / 谨慎参与 / 建议回避"**

---

## 三、DeFi 项目分类与列表

### 3.1 项目分类总览

| 分类 | 英文标识 | 说明 | 代表项目数 |
|-----|---------|------|-----------|
| 流动性质押 | `liquid-staking` | ETH 质押获取流动性代币 | 5+ |
| 再质押 | `restaking` | 质押资产再利用 | 3+ |
| 借贷协议 | `lending` | 存借款服务 | 6+ |
| 去中心化交易所 | `dex` | 代币兑换 | 6+ |
| DEX 聚合器 | `dex-aggregator` | 聚合多 DEX 最优价格 | 3+ |
| 收益优化 | `yield` | 收益聚合/优化 | 5+ |
| 衍生品 | `derivatives` | 期货、期权、永续合约 | 4+ |
| 稳定币 | `stablecoin` | 去中心化稳定币协议 | 3+ |
| 跨链桥 | `bridge` | 资产跨链 | 4+ |
| CDP/借贷 | `cdp` | 抵押债仓 | 2+ |

### 3.2 完整项目列表

#### 流动性质押 (Liquid Staking)

| 项目名称 | 合约地址 | TVL 量级 | 代币 |
|---------|---------|---------|------|
| **Lido Finance** | `0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84` | $38B+ | stETH, LDO |
| **Rocket Pool** | `0xae78736Cd615f374D3085123A210448E74Fc6393` | $3B+ | rETH, RPL |
| **Coinbase cbETH** | `0xBe9895146f7AF43049ca1c1AE358B0541Ea49704` | $2B+ | cbETH |
| **Frax Ether** | `0x5E8422345238F34275888049021821E8E08CAa1f` | $500M+ | frxETH, sfrxETH |
| **StakeWise** | `0xFe2e637202056d30016725477c5da089Ab0A043A` | $200M+ | sETH2, rETH2 |
| **Mantle mETH** | `0xd5F7838F5C461fefF7FE49ea5ebaF7728bB0ADfa` | $1B+ | mETH |
| **Swell** | `0xf951E335afb289353dc249e82926178EaC7DEd78` | $500M+ | swETH |

#### 再质押 (Restaking)

| 项目名称 | 合约地址 | TVL 量级 | 说明 |
|---------|---------|---------|------|
| **EigenLayer** | `0x39053D51B77DC0d36036Fc1fCc8Cb819df8Ef37A` | $15B+ | ETH 再质押领导者 |
| **Symbiotic** | `0x...` | $1B+ | 模块化再质押 |
| **Karak** | `0x...` | $1B+ | 多资产再质押 |
| **Ether.fi** | `0x35fA164735182de50811E8e2E824cFb9B6118ac2` | $5B+ | 流动性再质押 |
| **Renzo** | `0xbf5495Efe5DB9ce00f80364C8B423567e58d2110` | $3B+ | 流动性再质押 |
| **Puffer Finance** | `0xD9A442856C234a39a81a089C06451EBAa4306a72` | $1B+ | 原生再质押 |
| **Kelp DAO** | `0xA35b1B31Ce002FBF2058D22F30f95D405200A15b` | $1B+ | rsETH |

#### 借贷协议 (Lending)

| 项目名称 | 合约地址 | TVL 量级 | 版本 |
|---------|---------|---------|------|
| **Aave V3** | `0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2` | $15B+ | V3 Pool |
| **Aave V2** | `0x7d2768dE32b0b80b7a3454c06BdAc94A69DDc7A9` | $3B+ | V2 Pool |
| **Compound V3** | `0xc3d688B66703497DAA19211EEdff47f25384cdc3` | $3B+ | Comet USDC |
| **Compound V2** | `0x3d9819210A31b4961b30EF54bE2aeD79B9c9Cd3B` | $1B+ | Comptroller |
| **Spark Protocol** | `0xC13e21B648A5Ee794902342038FF3aDAB66BE987` | $4B+ | MakerDAO 官方 |
| **Morpho** | `0xBBBBBbbBBb9cC5e90e3b3Af64bdAF62C37EEFFCb` | $2B+ | 借贷优化器 |
| **Euler V2** | `0x...` | $500M+ | 模块化借贷 |
| **Silo Finance** | `0x...` | $200M+ | 隔离借贷 |

#### 去中心化交易所 (DEX)

| 项目名称 | 合约地址 | TVL 量级 | 类型 |
|---------|---------|---------|------|
| **Uniswap V3** | `0x1F98431c8aD98523631AE4a59f267346ea31F984` | $5B+ | AMM |
| **Uniswap V2** | `0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f` | $2B+ | AMM |
| **Curve Finance** | `0xD51a44d3FaE010294C616388b506AcdA1bfAAE46` | $2B+ | 稳定币 AMM |
| **Balancer V2** | `0xBA12222222228d8Ba445958a75a0704d566BF2C8` | $1B+ | 加权池 AMM |
| **SushiSwap** | `0xd9e1cE17f2641f24aE83637ab66a2cca9C378B9F` | $500M+ | AMM |
| **PancakeSwap V3** | `0x0BFbCF9fa4f9C56B0F40a671Ad40E0805A091865` | $300M+ | AMM (ETH) |
| **Maverick** | `0x...` | $100M+ | 动态分布 AMM |
| **Trader Joe** | `0x...` | $50M+ | Liquidity Book |

#### DEX 聚合器 (DEX Aggregator)

| 项目名称 | 合约地址 | 日交易量 | 特点 |
|---------|---------|---------|------|
| **1inch** | `0x1111111254EEB25477B68fb85Ed929f73A960582` | $1B+ | 最大聚合器 |
| **0x Protocol** | `0xDef1C0ded9bec7F1a1670819833240f027b25EfF` | $500M+ | API 服务 |
| **Paraswap** | `0xDEF171Fe48CF0115B1d80b88dc8eAB59176FEe57` | $200M+ | 多链聚合 |
| **CoW Swap** | `0x9008D19f58AAbD9eD0D60971565AA8510560ab41` | $300M+ | 批量拍卖 |
| **Odos** | `0x...` | $100M+ | 路由优化 |

#### 收益优化 (Yield)

| 项目名称 | 合约地址 | TVL 量级 | 类型 |
|---------|---------|---------|------|
| **Convex Finance** | `0xF403C135812408BFbE8713b5A23a04b3D48AAE31` | $2B+ | Curve 增强 |
| **Yearn Finance** | `0xa354F35829Ae975e850e23e9615b11Da1B3dC4DE` | $500M+ | 收益聚合 |
| **Pendle** | `0x0c880f6761F1af8d9Aa9C466984b80DAb9a8c9e8` | $5B+ | 收益代币化 |
| **Stake DAO** | `0x...` | $100M+ | 多策略 |
| **Beefy Finance** | `0x...` | $200M+ | 自动复投 |
| **Concentrator** | `0x...` | $100M+ | Convex 优化 |

#### 衍生品 (Derivatives)

| 项目名称 | 合约地址 | TVL/OI | 类型 |
|---------|---------|--------|------|
| **GMX V2** | `0x...` | $500M+ | 永续合约 |
| **dYdX** | `0x...` | $300M+ | 订单簿永续 |
| **Synthetix** | `0x...` | $300M+ | 合成资产 |
| **Gains Network** | `0x...` | $100M+ | 杠杆交易 |
| **Lyra** | `0x...` | $50M+ | 期权协议 |
| **Dopex** | `0x...` | $30M+ | 期权协议 |

#### 稳定币协议 (Stablecoin)

| 项目名称 | 合约地址 | 发行量 | 稳定币 |
|---------|---------|--------|-------|
| **MakerDAO** | `0x9f8F72aA9304c8B593d555F12eF6589cC3A579A2` | $5B+ | DAI |
| **Liquity** | `0x...` | $500M+ | LUSD |
| **Frax Finance** | `0x853d955aCEf822Db058eb8505911ED77F175b99e` | $1B+ | FRAX |
| **Ethena** | `0x...` | $3B+ | USDe |
| **crvUSD** | `0x...` | $500M+ | crvUSD |

#### 跨链桥 (Bridge)

| 项目名称 | 合约地址 | TVL 量级 | 说明 |
|---------|---------|---------|------|
| **Stargate** | `0x...` | $500M+ | LayerZero 桥 |
| **Across** | `0x...` | $100M+ | 意图桥 |
| **Hop Protocol** | `0x...` | $50M+ | L2 快速桥 |
| **Synapse** | `0x...` | $100M+ | 多链桥 |
| **Celer cBridge** | `0x...` | $100M+ | 状态通道桥 |

#### CDP/抵押借贷 (CDP)

| 项目名称 | 合约地址 | TVL 量级 | 说明 |
|---------|---------|---------|------|
| **MakerDAO** | `0x...` | $8B+ | DAI CDP |
| **Liquity** | `0x...` | $500M+ | LUSD Trove |
| **Reflexer** | `0x...` | $50M+ | RAI |

---

## 四、核心功能

### 4.1 功能清单（MVP）

| 功能 | 优先级 | 说明 |
|-----|--------|------|
| 项目列表展示 | P0 | 首页展示推荐项目 |
| 项目详情页 | P0 | 展示评分、风险、来源 |
| 后台项目管理 | P0 | CRUD + 评分编辑 |
| 用户搜索 | P0 | 搜索已收录项目 |
| RAG 实时查询 | P1 | 未收录项目的 RAG 分析 |
| 外部数据对接 | P1 | DefiLlama TVL 数据 |

### 4.2 功能简述

#### 前端展示
- **首页**：推荐项目卡片列表
- **分类页**：按类型筛选项目
- **详情页**：评分报告 + 风险提示 + 信息来源

#### 后台管理
- 项目 CRUD
- 评分手动编辑（运营更新）
- 上传相关文档到 RAG

---

## 五、数据模型（简化版）

```sql
-- 项目表
CREATE TABLE projects (
    id UUID PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    slug VARCHAR(100) UNIQUE NOT NULL,
    category VARCHAR(50) NOT NULL,        -- liquid-staking, lending, dex...
    logo_url TEXT,
    website VARCHAR(255),
    contract_address VARCHAR(42),         -- 主合约地址
    description TEXT,

    -- 评分数据（运营编辑）
    overall_score INTEGER,                -- 0-100
    risk_level VARCHAR(20),               -- low/medium/high/critical
    score_details JSONB,                  -- 各维度评分
    risk_warnings TEXT[],                 -- 风险提示

    -- 运营数据
    tvl DECIMAL,                          -- 从 DefiLlama 同步
    tvl_updated_at TIMESTAMP,

    -- 状态
    status VARCHAR(20) DEFAULT 'draft',   -- draft/published
    is_featured BOOLEAN DEFAULT FALSE,

    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- 评分维度 JSON 示例
-- score_details: {
--   "contract_security": {"score": 90, "factors": ["已审计", "开源"]},
--   "team": {"score": 85, "factors": ["团队公开"]},
--   "tokenomics": {"score": 80, "factors": ["分配合理"]},
--   "operation": {"score": 85, "factors": ["TVL 稳定"]}
-- }
```

---

## 六、外部数据源

### 6.1 DefiLlama API

用于获取项目 TVL 等运营数据。

**API 示例**：
```bash
# 获取协议 TVL
GET https://api.llama.fi/protocol/{protocol}

# 获取所有协议列表
GET https://api.llama.fi/protocols
```

**同步策略**：
- 后台手动触发同步
- 或定时任务（可选）

### 6.2 其他数据源（可选扩展）

| 数据源 | 用途 |
|-------|------|
| CoinGecko | 代币价格 |
| Etherscan | 合约验证状态 |
| DeFi Safety | 安全评分参考 |

---

## 七、系统架构（简化版）

```
┌────────────────────────────────────────────────────┐
│                   前端 (React)                      │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐         │
│  │  首页    │  │  列表页   │  │  详情页   │         │
│  └──────────┘  └──────────┘  └──────────┘         │
└────────────────────────────────────────────────────┘
                         │
                         ▼
┌────────────────────────────────────────────────────┐
│              后端 API (FastAPI)                     │
│  ┌──────────────────────────────────────────────┐ │
│  │  GET /projects          - 项目列表            │ │
│  │  GET /projects/{slug}   - 项目详情            │ │
│  │  POST /search           - 搜索/RAG 查询       │ │
│  └──────────────────────────────────────────────┘ │
└────────────────────────────────────────────────────┘
                         │
          ┌──────────────┼──────────────┐
          ▼              ▼              ▼
    ┌──────────┐   ┌──────────┐   ┌──────────┐
    │PostgreSQL│   │ pgvector │   │DefiLlama │
    │ 项目数据  │   │RAG 知识库│   │  API     │
    └──────────┘   └──────────┘   └──────────┘
```

---

## 八、评分体系

### 8.1 评分维度（简化）

| 维度 | 权重 | 评估要点 |
|-----|------|---------|
| 合约安全 | 35% | 审计、开源、历史漏洞 |
| 团队背景 | 25% | 公开度、投资机构 |
| 代币经济 | 20% | 分配、解锁、抛压 |
| 运营数据 | 20% | TVL、用户、增长 |

### 8.2 风险等级

| 等级 | 分数 | 标识颜色 |
|-----|------|---------|
| 低风险 | 80-100 | 绿色 |
| 中风险 | 60-79 | 黄色 |
| 高风险 | 40-59 | 橙色 |
| 极高风险 | 0-39 | 红色 |

---

## 九、页面设计要点

### 9.1 首页
- 搜索框（顶部）
- 推荐项目卡片（3-4 列网格）
- 分类标签导航

### 9.2 项目卡片
```
┌─────────────────────────────┐
│  [Logo]  Lido Finance       │
│  流动性质押 | Ethereum       │
│                             │
│  评分: 85/100  [低风险]      │
│  TVL: $38.5B                │
└─────────────────────────────┘
```

### 9.3 详情页
- 项目基本信息
- 评分概览（总分 + 维度图表）
- 风险提示列表
- 信息来源（可点击链接）
- RAG 生成的分析摘要

---

## 十、技术选型

| 层级 | 选型 | 说明 |
|-----|------|------|
| 前端 | React + TailwindCSS | 复用现有技术栈 |
| 后端 | FastAPI | 复用 RAG Service |
| 数据库 | PostgreSQL + pgvector | 复用现有 |
| 外部 API | DefiLlama | TVL 数据 |

---

## 十一、下一步

1. **确认 MVP 范围**：从上面项目列表选取 10-20 个做 Demo
2. **设计数据库表**：基于简化模型
3. **对接 DefiLlama**：获取 TVL 数据
4. **前端原型**：首页 + 详情页
5. **后台扩展**：项目管理功能

---

*文档版本：v0.3 (含市场分析)*
*更新日期：2025-01-15*
*定位：轻量级 Demo 项目*
